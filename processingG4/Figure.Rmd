---
title: "NbG4"
author: "Anaïs Vannutelli"
date: "April 24, 2019"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Densité de G4 par CG content

```{r}
nbG4 <- read.delim("~/Documents/Data/Genomes/All_sp/nbG4.tsv", stringsAsFactors = FALSE)
label = nbG4[1,]
nbG4 = nbG4[2:62,]
tablePlot = data.frame(as.numeric(as.character(nbG4$Density)), as.numeric(as.character(nbG4$GC.content)), nbG4$X.1, nbG4[,1])
rownames(tablePlot) = nbG4[,1]
library(ggplot2)
#install.packages('ggplot2')
ggplot(tablePlot, aes(x=tablePlot$as.numeric.as.character.nbG4.GC.content.., y=tablePlot$as.numeric.as.character.nbG4.Density.., color=tablePlot$nbG4.X.1)) + 
    geom_point(size=5, alpha=0.6) + 
    labs(title = 'Densité de pG4 (pG4/kb) en fonction du contenu en GC (%) ', x = 'Contenu en GC', y = 'Densité de pG4 (pG4/kb)', colour = 'Clade', caption = "Données des gènes") + ylim(0, 0.35)

ggplot(tablePlot, aes(x=tablePlot$as.numeric.as.character.nbG4.Density.., y=tablePlot$as.numeric.as.character.nbG4.GC.content.., color=tablePlot$nbG4.X.1, label = tablePlot$nbG4...1.)) + 
    geom_point() + geom_text(aes(label = tablePlot$nbG4...1.)) +
    labs(title = 'Density of pG4 (pG4/kb) and GC content', x = 'Density of pG4 (pG4/kb)', y = '% of GC in genes', colour = 'Clade', caption = "based on data from genes") + xlim(0, 0.35)
```

# BoxPlot score

```{r}
# library
library(ggplot2)
 
# The mtcars dataset is proposed in R
head(mpg)
 
# plot
ggplot(diamonds, aes(x=carat, y=price)) +
  geom_boxplot(fill="skyblue", aes(group = cut_width(carat, 0.5)))
```


# line plot
```{r}
library(ggplot2)
Density_random <- read_delim("Documents/Data/Genomes/All_sp/Density_random.tsv", "\t", escape_double = FALSE, trim_ws = TRUE)

colnames(Density_random) <- c("Specie", "Value", "Type")
density = Density_random[1:124,]
GC = Density_random[125:186,]
attach(density)

density$Specie=factor(density$Specie, levels=unique(density$Specie))

p1 <- ggplot(density, aes(x=Specie, y=Value, group=Type)) +
      geom_line(aes(color=Type)) +
      geom_point(aes(color=Type)) +
      ggtitle("Density\n")+
      theme(axis.text.x = element_text(angle = 90, hjust = 1))+
      xlab("")
p1

p2 <- ggplot(GC, aes(x=Specie, y=Value, group=Type)) +
      geom_line(aes(color=Type)) +
      geom_point(aes(color=Type)) +
      ggtitle("GC content\n")
p2

# make gtable objects from ggplot objects
# gtable object shows how grobs are put together to form a ggplot
g1 <- ggplot_gtable(ggplot_build(p1))
g2 <- ggplot_gtable(ggplot_build(p2))

# get the location of the panel of p1 
# so that the panel of p2 is positioned correctly on top of it
pp <- c(subset(g1$layout, name == "panel", se = t:r))

# superimpose p2 (the panel) on p1
g <- gtable_add_grob(g1, g2$grobs[[which(g2$layout$name == "panel")]], pp$t, 
pp$l, pp$b, pp$l)

# extract the y-axis of p2
ia <- which(g2$layout$name == "axis-l")
ga <- g2$grobs[[ia]]
ax <- ga$children[[2]]

# flip it horizontally
ax$widths <- rev(ax$widths)
ax$grobs <- rev(ax$grobs)

# add the flipped y-axis to the right
g <- gtable_add_cols(g, g2$widths[g2$layout[ia, ]$l], length(g$widths) - 1)
g <- gtable_add_grob(g, ax, pp$t, length(g$widths) - 1, pp$b)

grid.draw(g)
```

