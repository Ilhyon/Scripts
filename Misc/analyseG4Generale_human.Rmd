---
title: "classification k-mer"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#install.packages("stringr", dependencies=TRUE)
library(stringr)
```

# Chargement des données

```{r}
Data_HS = read.csv('/home/local/USHERBROOKE/vana2406/Documents/Data/human/HS_All_G4InTranscript.txt', header = F, sep = "\t")
colnames(Data_HS) = c("InfoG4ByTranscript","cGcC","G4Hunter","sequenceG4","G4NN","localisation","transcriptBiotype")
```

## Analyse

```{r}
table_localisation = table(Data_HS$localisation)
table_biotype = table(Data_HS$transcriptBiotype)
pie(table_localisation)
pie(table_biotype)
pie(table(str_length(Data_HS$sequenceG4)))
```

On voit qu'il y a une majorité de région rG4s de 60 nucléotides. Plus un rG4s est grand, moins il est fréquent.

## Récupération des petites familles

```{r}
which(table_biotype <= 100)
```

Les résultats obtenus avec le which ne sont pas les mêmes que ceux en affichant dirrectement le table. Pourquoi ?

## Petite famille : IG_C_gene

```{r}
which(Data_HS$transcriptBiotype == "IG_C_gene")
Data_HS_IG_C_gene = which(Data_HS$transcriptBiotype == "IG_C_gene")
Data_HS_IG_C_gene = Data_HS[Data_HS_IG_C_gene,]
pie(table(Data_HS_IG_C_gene[,6]))
table(str_length(Data_HS_IG_C_gene[,4]))
#Data_HS_IG_C_gene[,4]
```

Pour cette famille il y a 11 rG4s. Il y en a 3 en 3', 6 en Intron et 2 Sur des jonctions CDS-Intron. 63% de ces rG4s font 60 nucléotides de longs.


## Petite famille : IG_V_gene

```{r}
which(Data_HS$transcriptBiotype == "IG_V_gene")
Data_HS_IG_V_gene = which(Data_HS$transcriptBiotype == "IG_V_gene")
Data_HS_IG_V_gene = Data_HS[Data_HS_IG_V_gene,]
pie(table(Data_HS_IG_V_gene[,6]))
table(str_length(Data_HS_IG_V_gene[,4]))
#Data_HS_IG_V_gene[,4]
```

## Petite famille : TR_C_gene

```{r}
which(Data_HS$transcriptBiotype == "TR_C_gene")
Data_HS_TR_C_gene = which(Data_HS$transcriptBiotype == "TR_C_gene")
Data_HS_TR_C_gene = Data_HS[Data_HS_TR_C_gene,]
pie(table(Data_HS_TR_C_gene[,6]))
table(str_length(Data_HS_TR_C_gene[,4]))
#Data_HS_TR_C_gene[,4]
```

## Petite famille : TR_V_gene

```{r}
which(Data_HS$transcriptBiotype == "TR_V_gene")
Data_HS_TR_V_gene = which(Data_HS$transcriptBiotype == "TR_V_gene")
Data_HS_TR_V_gene = Data_HS[Data_HS_TR_V_gene,]
pie(table(Data_HS_TR_V_gene[,6]))
table(str_length(Data_HS_TR_V_gene[,4]))
#Data_HS_TR_V_gene[,4]
```

## Petite famille : non_stop_decay

```{r}
which(Data_HS$transcriptBiotype == "non_stop_decay")
Data_HS_non_stop_decay = which(Data_HS$transcriptBiotype == "non_stop_decay")
Data_HS_non_stop_decay = Data_HS[Data_HS_non_stop_decay,]
pie(table(Data_HS_non_stop_decay[,6]))
table(str_length(Data_HS_non_stop_decay[,4]))
#Data_HS_non_stop_decay[,4]
View(Data_HS_non_stop_decay[which(Data_HS_non_stop_decay$localisation == "junction_CDS_Intron"),])
```

